version: 2.1

jobs:
  # Backend job
  backend_build:
    docker:
      - image: cimg/node:20.5 # Node.js Docker image
    working_directory: ~/repo
    steps:
      - checkout
      - run: cd backend && npm install
      - run: cd backend && npm run test || echo "No tests yet"
  
  # Frontend job
  frontend_build:
  docker:
    - image: cimg/node:20.5
  working_directory: ~/repo
  steps:
    - checkout
    - run: cd frontend && npm install
    - run: chmod +x ./frontend/node_modules/.bin/react-scripts
    - run: cd frontend && npm run build

workflows:
  version: 2
  build_and_test:
    jobs:
      - backend_build
      - frontend_build
